(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{95492:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});Object.create;Object.create;var r=n(67294);function o(...e){const t=[];for(const n of e)n&&("string"===typeof n?t.push(n):n.hasOwnProperty("toString")&&"function"===typeof n.toString&&t.push(n.toString()));return t.join(" ")}var a=(e,t)=>{const n=t=>{var{primaryFill:n="currentColor"}=t,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["primaryFill"]);const{className:i}=a,s=a["aria-label"]||a["aria-labelledby"]||a.title?{role:"img"}:{"aria-hidden":!0};return r.createElement("span",Object.assign({},a,s,{className:o("root-span",i)}),r.cloneElement(e,{className:"svg",fill:n}))};return n.displayName=t,n}},44303:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/meeting",function(){return n(79857)}])},54142:function(e,t){"use strict";t.Z={src:"/communications/_next/static/media/logo-tampa-msft.87fcc76f.webp",height:36,width:158,blurDataURL:"data:image/webp;base64,UklGRmwAAABXRUJQVlA4WAoAAAAQAAAABwAAAQAAQUxQSBEAAAAAxYc7Uzs0MTaHXENSRUdDKQBWUDggNAAAABACAJ0BKggAAgACQDglAE6I4AyQAFDlvPAA/q1Oi2ch/TZVww/4JUebA/4Jfd0jR3IgAAA="}},46930:function(e,t,n){"use strict";n.d(t,{w:function(){return l}});var r=n(14251),o=n(52875),a=n(44747),i=n(85893),s=n(13396),c=n(61925),l=function(e){var t=e.children,n=e.onClick,l=e.disableTelemetry,u=(0,a.Z)(e,["children","onClick","disableTelemetry"]);return(0,i.jsx)(s.h,(0,o.Z)((0,r.Z)({onClick:function(t){if(!l){var r=e.buttonName,o=e.contextInfo,a=e.additionalContext;(0,c.M)({buttonType:c.D.Icon,buttonName:r,contextInfo:o,additionalContext:a})}n&&n(t)}},u),{children:t}))}},61925:function(e,t,n){"use strict";n.d(t,{D:function(){return r},M:function(){return s}});var r,o=n(14251),a=n(69387),i=n(46202);!function(e){e.Primary="Primary",e.Secondary="Secondary",e.Base="Base",e.Link="Link",e.Icon="Icon",e.Action="Action",e.Default="Default",e.CommandBar="CommandBar"}(r||(r={}));var s=function(e){var t=e.buttonName,n=e.contextInfo,r=e.additionalContext,s=e.buttonType,c={name:a.tw.ButtonClick,metricDimensions:(0,o.Z)({name:t,contextName:n.name,contextType:n.type,buttonType:s},n.region&&{contextRegion:n.region},r)};i.k.logEvent(c)}},46348:function(e,t,n){"use strict";n.d(t,{y:function(){return s}});var r=n(85893),o=n(75568),a=n(56836),i=n.n(a),s=function(){return(0,r.jsx)(o.default,{color:i().colorblue,startPosition:.3,stopDelayMs:200,height:2,showOnShallow:!0,options:{showSpinner:!1,parent:"#__next"}})}},79735:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var r=n(85893),o=n(52672),a=n(14107),i=function(e){var t=e.labelKey,n=(0,a.$G)("communication").t;return(0,r.jsxs)("div",{className:"flex h-full flex-col items-center justify-center font-muli text-base tracking-wider text-deprecated-theme-blue",children:[(0,r.jsx)(o.J,{className:"mb-2 h-5 w-5",iconName:"CircleRing"}),n(t)]})}},1037:function(e,t,n){"use strict";n.d(t,{M:function(){return o}});var r=n(67294);function o(e,t){(0,r.useEffect)((function(){t&&t(e)}),[e,t])}},29746:function(e,t,n){"use strict";n.d(t,{A:function(){return o},c:function(){return a}});var r=n(67294),o=(0,r.createContext)(void 0),a=function(){var e=(0,r.useContext)(o);if(!e)throw Error("Cannot find Virtual Classroom Context please initialize before usage.");return e}},79857:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return ae},default:function(){return ie}});var r=n(85893),o=n(59774),a=n(67294),i=n(1037),s=n(46348),c=n(57206),l=n(95492);var u=(0,l.Z)((e=>{const{className:t,primaryFill:n}=e;return a.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",className:t},a.createElement("path",{d:"M10 14.5a4.5 4.5 0 100-9 4.5 4.5 0 000 9z",fill:n}),a.createElement("path",{d:"M10 2a8 8 0 100 16 8 8 0 000-16zm-7 8a7 7 0 1114 0 7 7 0 01-14 0z",fill:n}))})({}),"Record20Regular");var d=(0,l.Z)((e=>{const{className:t,primaryFill:n}=e;return a.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:t},a.createElement("path",{d:"M3.28 2.22a.75.75 0 10-1.06 1.06l2.2 2.2a9.96 9.96 0 00-1.3 11.11l-1.07 3.83a1.25 1.25 0 001.54 1.54l3.82-1.07a9.96 9.96 0 0011.11-1.3l2.2 2.19a.75.75 0 001.06-1.06L3.28 2.22zm14.18 16.3a8.47 8.47 0 01-9.6.91l-.26-.15-3.99 1.11 1.11-3.98-.15-.27a8.46 8.46 0 01.91-9.6l3 3A.75.75 0 008.76 11h1.19l2 2H8.65a.75.75 0 00.1 1.5h4.6l.07-.02 4.04 4.04z",fill:n}),a.createElement("path",{d:"M15.25 9.5h-2.57l1.5 1.5H15.35a.75.75 0 00-.1-1.5z",fill:n}),a.createElement("path",{d:"M20.5 12c0 1.53-.4 2.97-1.11 4.2l1.1 1.1A10 10 0 006.7 3.52l1.08 1.1A8.5 8.5 0 0120.5 12z",fill:n}))})({}),"ChatOff24Regular");var m=(0,l.Z)((e=>{const{className:t,primaryFill:n}=e;return a.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:t},a.createElement("path",{d:"M12 2a10 10 0 11-4.59 18.89L3.6 21.96a1.25 1.25 0 01-1.54-1.54l1.06-3.83A10 10 0 0112 2zm0 1.5a8.5 8.5 0 00-7.43 12.64l.15.27-1.1 3.98 3.98-1.11.27.15A8.5 8.5 0 1012 3.5zM8.75 13h4.5a.75.75 0 01.1 1.5h-4.6a.75.75 0 01-.1-1.5h4.6-4.5zm0-3.5h6.5a.75.75 0 01.1 1.5h-6.6a.75.75 0 01-.1-1.5h6.6-6.5z",fill:n}))})({}),"Chat24Regular"),h=n(25675),f=n.n(h),g=n(14107),v=n(46930),p=n(69387),x=n(29746),w=n(54142);var C=(0,l.Z)((e=>{const{className:t,primaryFill:n}=e;return a.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:t},a.createElement("path",{d:"M7.75 12a1.75 1.75 0 11-3.5 0 1.75 1.75 0 013.5 0z",fill:n}),a.createElement("path",{d:"M13.75 12a1.75 1.75 0 11-3.5 0 1.75 1.75 0 013.5 0z",fill:n}),a.createElement("path",{d:"M18 13.75a1.75 1.75 0 100-3.5 1.75 1.75 0 000 3.5z",fill:n}))})({}),"MoreHorizontal24Regular"),_=n(61925),b=n(82201),y=n(34727),N=n(34051),A=n.n(N),I=n(32692),S=n(81621);function k(){var e=(0,I.Z)(["\n  mutation setStartRecording($serverCallId: String!) {\n    recordingId: VirtualClassroomMutations_StartCallRecording(serverCallId: $serverCallId)\n  }\n"]);return k=function(){return e},e}function E(){var e=(0,I.Z)(["\n  mutation setStopRecording($serverCallId: String!) {\n    success: VirtualClassroomMutations_StopRecording(serverCallId: $serverCallId)\n  }\n"]);return E=function(){return e},e}var j=(0,S.Ps)(k()),R=(0,S.Ps)(E()),V=function(){var e=(0,y.Z)(A().mark((function e(t,n){var r;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.mutate({mutation:j,variables:{serverCallId:n}});case 2:return r=e.sent.data,e.abrupt("return",null===r||void 0===r?void 0:r.recordingId);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),F=function(){var e=(0,y.Z)(A().mark((function e(t,n){var r;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.mutate({mutation:R,variables:{serverCallId:n}});case 2:return r=e.sent.data,e.abrupt("return",null===r||void 0===r?void 0:r.success);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=n(46202),z=n(27899),P=n.n(z),O=function(e){var t=e.contextInfo,n=(0,b.xJ)(),o=(0,g.$G)("virtualClassroom").t,i=(0,x.c)(),s=i.isRecording,c=i.isReadyToRecord,l=i.setIsPreparingToRecord,u=i.locator,d=(0,a.useState)(!1),m=d[0],h=d[1];(0,a.useEffect)((function(){h(!1),l(!1)}),[s,l]);var f={items:[{key:"recording",iconProps:{iconName:s?"CircleStopSolid":"CircleFill",style:{color:"crimson"}},text:o(s?"stopRecording":"startRecording"),onClick:s?function(){(0,_.M)({buttonType:_.D.Action,buttonName:p.$S.StopRecording,contextInfo:t}),h(!0),F(n,u).catch((function(e){M.k.logError("Failed to stop recording - ".concat(e.toString())),h(!1)}))}:function(){(0,_.M)({buttonType:_.D.Action,buttonName:p.$S.StartRecording,contextInfo:t}),h(!0),l(!0),V(n,u).catch((function(e){M.k.logError("Failed to start recording - ".concat(e.toString())),h(!1),l(!1)}))},disabled:!c||m}],onRestoreFocus:function(){M.k.logInfo("Closing virtual classroom more actions menu")}};return(0,r.jsx)(v.w,{className:P().button,buttonName:p.$S.MoreActions,contextInfo:t,menuProps:f,menuIconProps:{className:P().moreActionsMenuIcon},children:(0,r.jsx)(C,{})})};var T=(0,l.Z)((e=>{const{className:t,primaryFill:n}=e;return a.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:t},a.createElement("path",{d:"M3 6.25C3 4.45 4.46 3 6.25 3h11.5C19.55 3 21 4.46 21 6.25v11.5c0 1.8-1.46 3.25-3.25 3.25H6.25A3.25 3.25 0 013 17.75V6.25zM6.25 4.5c-.97 0-1.75.78-1.75 1.75v5h6.75V4.5h-5zm5 8.25H4.5v5c0 .97.78 1.75 1.75 1.75h5v-6.75zm1.5 0v6.75h5c.97 0 1.75-.78 1.75-1.75v-5h-6.75zm6.75-1.5v-5c0-.97-.78-1.75-1.75-1.75h-5v6.75h6.75z",fill:n}))})({}),"TableSimple24Regular"),L=n(75671),H=n.n(L),B=function(e){var t=e.contextInfo,n=(0,g.$G)("virtualClassroom").t,o=(0,x.c)(),i=o.layout,s=o.setLayout,c=(0,a.useState)(!1),l=c[0],u=c[1],d={items:[{key:"fullScreen",iconProps:{iconName:l?"BackToWindow":"FitPage"},text:n(l?"exitFullScreen":"fullScreen"),onClick:function(){var e=document.documentElement,t=document;function n(){t.fullscreenElement||t.webkitIsFullScreen||t.mozFullScreen||t.msFullscreenElement||(u(!1),document.removeEventListener("fullscreenchange",n),document.removeEventListener("webkitfullscreenchange",n),document.removeEventListener("mozfullscreenchange",n),document.removeEventListener("MSFullscreenChange",n))}l?t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.msExitFullscreen&&t.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),u(!l),document.addEventListener("fullscreenchange",n),document.addEventListener("webkitfullscreenchange",n),document.addEventListener("mozfullscreenchange",n),document.addEventListener("MSFullscreenChange",n)}},{key:"changeView",iconProps:{iconName:"floatingLocalVideo"===i?"MiniContractMirrored":"DoubleColumn"},text:n("floatingLocalVideo"===i?"modalView":"gridView"),onClick:function(){s("floatingLocalVideo"===i?"default":"floatingLocalVideo")},secondaryText:"\u2714"}],onRestoreFocus:function(){M.k.logInfo("Closing virtual classroom view menu")}};return(0,r.jsx)(v.w,{className:H().button,buttonName:p.$S.ViewButton,contextInfo:t,menuProps:d,menuIconProps:{className:H().menuIcon},children:(0,r.jsx)(T,{})})},G=n(63414),Z=n.n(G),U=function(e){var t=e.serviceName,n=e.otherUserName,o=e.showChat,a=e.toggleChat,i=(0,g.$G)("virtualClassroom").t,s=(0,x.c)().isRecording,l={type:p.Qy.Component,name:p.Ou.VirtualClassroomHeader};return(0,r.jsx)("header",{className:Z().header,children:(0,r.jsxs)("div",{className:Z().container,children:[(0,r.jsx)("div",{className:Z().logo,children:(0,r.jsx)(f(),{alt:i("mainPage"),layout:"fill",objectFit:"contain",src:w.Z,priority:!0})}),(0,r.jsxs)("p",{className:Z().meetingName,children:[s&&(0,r.jsx)(u,{className:Z().recordingIcon}),i("meetingName",{serviceName:t,otherUserName:n})]}),(0,r.jsxs)("div",{className:Z().right,children:[(0,r.jsx)(c.G,{className:Z().desktopOnly,hostClassName:Z().tooltipHost,content:i("moreActions"),children:(0,r.jsx)(O,{contextInfo:l})}),(0,r.jsx)(c.G,{className:Z().desktopOnly,hostClassName:Z().tooltipHost,content:i(o?"hideChat":"showChat"),children:(0,r.jsx)(v.w,{className:Z().icon,buttonName:o?p.$S.HideChat:p.$S.ShowChat,contextInfo:l,onClick:a,children:o?(0,r.jsx)(d,{}):(0,r.jsx)(m,{})})}),(0,r.jsx)(c.G,{hostClassName:"".concat(Z().tooltipHost," ").concat(Z().desktopOnly),content:i("changeYourView"),children:(0,r.jsx)(B,{contextInfo:l})})]})]})})},D=n(24394),$=n.n(D),Q=function(e){var t=e.children,n=e.serviceName,o=e.otherUserName,a=e.showChat,i=e.toggleChat;return(0,r.jsxs)("div",{children:[(0,r.jsx)(s.y,{}),(0,r.jsx)(U,{serviceName:n,otherUserName:o,showChat:a,toggleChat:i}),(0,r.jsx)("main",{className:$().main,children:t})]})},q=n(5152),W=n.n(q),J=n(79735),X=n(58651),K=n(35522),Y=n(69863),ee=n.n(Y),te=W()((function(){return Promise.all([n.e(597),n.e(729),n.e(945),n.e(187),n.e(148),n.e(773),n.e(956),n.e(917),n.e(503),n.e(60),n.e(860),n.e(513),n.e(156),n.e(143),n.e(911),n.e(324),n.e(470),n.e(853),n.e(954),n.e(664),n.e(491)]).then(n.bind(n,11552))}),{loadableGenerated:{webpack:function(){return[11552]}},ssr:!1}),ne=W()((function(){return Promise.all([n.e(597),n.e(729),n.e(945),n.e(187),n.e(148),n.e(773),n.e(956),n.e(917),n.e(503),n.e(60),n.e(860),n.e(513),n.e(156),n.e(143),n.e(911),n.e(843),n.e(355),n.e(296),n.e(81),n.e(965),n.e(198),n.e(554),n.e(954),n.e(739),n.e(579),n.e(414)]).then(n.bind(n,50508))}),{loadableGenerated:{webpack:function(){return[50508]}},ssr:!1,loading:function(){return(0,r.jsx)(J.g,{labelKey:"loadingMessages"})}}),re=function(e){var t=e.userId,n=e.token,o=e.displayName,a=e.locator,i=e.threadId,s=e.showChat,c=e.retainChat,l=e.contextInfo,u=e.hybridAuthToken,d=(0,K.X)();return(0,r.jsxs)("div",{className:ee().container,children:[(0,r.jsx)("div",{className:(0,X.c)(ee().call,s&&d?ee().hide:""),children:(0,r.jsx)(te,{userId:t,token:n,locator:a,displayName:o,contextInfo:l})}),c&&(0,r.jsx)("div",{className:(0,X.c)(ee().chat,s?"":ee().hide),children:(0,r.jsx)(ne,{userId:t,token:n,locator:a,threadId:i,displayName:o,contextInfo:l,hybridAuthToken:u})})]})};(0,o.Mg)(void 0,{disableWarnings:!0});var oe={type:p.Qy.Page,name:p.q.VirtualClassroom},ae=!0,ie=(0,b.CG)((function(e){var t=e.userId,n=e.token,o=e.locator,s=e.threadId,c=e.serviceName,l=e.displayName,u=e.otherUserName,d=e.hybridAuthToken,m=e.trackPageView,h=(0,a.useState)(!1),f=h[0],g=h[1],v=(0,a.useState)(!1),w=v[0],C=v[1],_=(0,a.useState)(!1),b=_[0],y=_[1],N=(0,a.useState)(!1),A=N[0],I=N[1],S=(0,a.useState)(!1),k=S[0],E=S[1],j=(0,a.useState)("floatingLocalVideo"),R=j[0],V=j[1];(0,i.M)(p.q.VirtualClassroom,m);var F=(0,a.useCallback)((function(){g((function(e){return!e})),C(!0)}),[]);return(0,r.jsx)(x.A.Provider,{value:{isRecording:b,setIsRecording:y,isReadyToRecord:A,setIsReadyToRecord:I,isPreparingToRecord:k,setIsPreparingToRecord:E,locator:o,layout:R,setLayout:V},children:(0,r.jsx)(Q,{serviceName:c,otherUserName:u,showChat:f,toggleChat:F,children:(0,r.jsx)(re,{userId:t,token:n,displayName:l,locator:o,threadId:s,showChat:f,retainChat:w,contextInfo:oe,hybridAuthToken:null!==d&&void 0!==d?d:void 0})})})}))},58651:function(e,t,n){"use strict";function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return!!e})).join(" ")}n.d(t,{c:function(){return r}})},35522:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});var r=n(67294),o=n(21691),a=function(e){var t=(0,r.useState)(o.bG?0:window.innerWidth),n=t[0],a=t[1];return(0,r.useEffect)((function(){if(!o.bG){var e=function(){a(window.innerWidth)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),n<=(e||768)}},56836:function(e){e.exports={colorblue:"var(--old-primary-color)"}},27899:function(e){e.exports={button:"MoreActions_button__CxBcj",moreActionsMenuIcon:"MoreActions_moreActionsMenuIcon___2Y2U"}},75671:function(e){e.exports={button:"ViewButton_button__GcEeU",menuIcon:"ViewButton_menuIcon__pbiHW"}},63414:function(e){e.exports={header:"VirtualClassroomHeader_header__4Tp1C",headerFixed:"VirtualClassroomHeader_headerFixed__whGMq",container:"VirtualClassroomHeader_container__l52x9",meetingName:"VirtualClassroomHeader_meetingName__8Qbun",recordingIcon:"VirtualClassroomHeader_recordingIcon__yfzGw",logo:"VirtualClassroomHeader_logo__4gMLs",right:"VirtualClassroomHeader_right__NOQGZ",tooltipHost:"VirtualClassroomHeader_tooltipHost__5FVdG",icon:"VirtualClassroomHeader_icon__g_hyD",desktopOnly:"VirtualClassroomHeader_desktopOnly__IdVd_"}},24394:function(e){e.exports={main:"VirtualClassroomLayout_main__tcegd"}},69863:function(e){e.exports={container:"VirtualClassroomContainer_container__L_8_W",call:"VirtualClassroomContainer_call__WulOO",hide:"VirtualClassroomContainer_hide__gVQcb",chat:"VirtualClassroomContainer_chat__udPN1"}}},function(e){e.O(0,[597,553,193,593,307,533,774,888,179],(function(){return t=44303,e(e.s=t);var t}));var t=e.O();_N_E=t}]);